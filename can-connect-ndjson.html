<!DOCTYPE html>
<html>
<head>
	<script type="text/stache" id="app-template">
		<ul>
			{{#each todosPromise.value}}
				<li>{{name}}</li>
			{{/each}}
		</ul>
	</script>
	<script src="./node_modules/steal/steal.js" main="@empty">
	var ndjsonStream = require("can-connect-ndjson");
	var connect = require("can-connect");
	var DefineList = require("can-define/list/list");
	var DefineMap = require("can-define/map/map");

	// Define types
	var Todo = DefineMap.extend("Todo",{
	  id: "number",
	  name: "string"
	});
	Todo.List = DefineList.extend({
	  "#": Todo
	});

	// create connection
	Todo.connection = connect([
	  require("can-connect/data/url/url"),
	  require("can-connect/constructor/constructor"),
	  require("can-connect/constructor/store/store"),
	  require("can-connect/can/map/map"),
	  require("can-connect-ndjson")
	],{
	  Map: Todo,
	  List: Todo.List,
	  url: "/api/todos",
	  // ndjson: "/api/todos.ndjson"
	  ndjson: "http://localhost/ndjson.php"
	});
	var stache = require("can-stache");
	var template = stache.from("app-template");
	var frag = template({ todosPromise: Todo.getList({}) });
	document.body.appendChild(frag);
	</script>
</head>
<body>

</body>
</html>
